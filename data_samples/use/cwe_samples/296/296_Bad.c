
                  if ((cert = SSL_get_peer_certificate(ssl)) && host)foo=SSL_get_verify_result(ssl);
                     if ((X509_V_OK==foo) || X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN==foo))
                        
                           
                           // certificate looks good, host can be trusted
                           
                        
                     
                  
               
               